webpackJsonp([363],{Iji3:function(e,t,r){(t=e.exports=r("FZ+f")(!1)).push([e.i,".app-Vu6bW5dD{width:368px;margin:0 auto}@media screen and (max-width:576px){.app-Vu6bW5dD{width:95%}}.app-Vu6bW5dD .app-1_TGTJ4K{font-size:24px;color:rgba(0,0,0,.2);margin-left:16px;vertical-align:middle;cursor:pointer;-webkit-transition:color .3s;-o-transition:color .3s;transition:color .3s}.app-Vu6bW5dD .app-1_TGTJ4K:hover{color:#1890ff}.app-Vu6bW5dD .app-2880ZsoL{text-align:left;margin-top:24px;line-height:22px}.app-Vu6bW5dD .app-2880ZsoL .app-1t7LEZSJ{float:right}.app-Vu6bW5dD .app-F2ZNTFL3{display:block;width:100%;height:40px;font-size:16px}.app-Vu6bW5dD .app-23gpwh_z{background-color:#ff915e;border-color:#ff915e;padding:6px 11px}.app-Vu6bW5dD .app-3d1xsE34,.app-Vu6bW5dD .app-23gpwh_z{width:100%;height:40px;font-size:16px}.app-Vu6bW5dD .app-3hePtdB6 .ant-checkbox-checked .ant-checkbox-inner{background-color:#ff915e;border-color:#ff915e}",""]),t.locals={main:"app-Vu6bW5dD",icon:"app-1_TGTJ4K",other:"app-2880ZsoL",register:"app-1t7LEZSJ",getCaptcha:"app-F2ZNTFL3",buttonRest:"app-23gpwh_z",restInput:"app-3d1xsE34",auto_login:"app-3hePtdB6"}},QvYd:function(e,t,r){var a=r("Iji3");"string"===typeof a&&(a=[[e.i,a,""]]);var s={hmr:!1,transform:void 0};r("MTIv")(a,s);a.locals&&(e.exports=a.locals)},"U0+v":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r("crfj");var a=r("zwGx"),s=(r("JYrs"),r("QoDT")),o=(r("faxx"),r("FV1P")),n=(r("baa2"),r("FC3+")),i=(r("LHBr"),r("A+AJ")),p=(r("gZEk"),r("8rR3")),l=(r("QX4N"),r("Gj0I")),c=r("Dd8w"),u=r.n(c),d=r("Zrlr"),m=r.n(d),h=r("wxAW"),f=r.n(h),g=r("zwoO"),b=r.n(g),v=r("Pf15"),w=r.n(v),I=r("OeRD"),x=r("GiK3"),y=r.n(x),E=r("RH2O"),k=r("QvYd"),D=function(e){function t(e){m()(this,t);var r=b()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.setInterval=function(){r.timer()},r.timer=function(){return setInterval(r.countDown,1e3)},r.send=function(){r.setState({counting:!0,count:60}),r.setInterval()},r.countDown=function(){var e=r.state.count;1===e?(r.clearInterval(),r.setState({counting:!1})):r.setState({counting:!0,count:e-1})},r.clearInterval=function(){clearInterval(r.timer())},r.state={count:0,counting:!1},r}return w()(t,e),f()(t,[{key:"componentWillReceiveProps",value:function(e){!e.restError&&this.props.submitting&&!1===e.submitting?e.passwordModel&&"200"===e.passwordModel.code?(window.history.back(),l.a.success({message:"\u63d0\u9192",description:"\u5bc6\u7801\u4fee\u6539\u6210\u529f"})):l.a.error({message:"\u63d0\u9192",description:"\u5bc6\u7801\u4fee\u6539\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5"}):e.restError&&this.props.restError!==e.restError&&l.a.error({message:"\u5bc6\u7801\u4fee\u6539\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5",description:e.restError.message})}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer())}},{key:"handleSubmit",value:function(){var e=this,t=this.props.form.getFieldValue("code"),r=this.props.form.getFieldValue("password");""!==t&&null!==t||l.a.error({message:"\u63d0\u9192",description:"\u9a8c\u8bc1\u7801\u4e3a\u7a7a,\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801"}),""!==r&&null!==r||l.a.error({message:"\u63d0\u9192",description:"\u5bc6\u7801\u4e3a\u7a7a,\u8bf7\u8f93\u5165\u5bc6\u7801"}),this.props.form.validateFields(function(t,r){t||e.props.reset(u()(u()({},r),{sessionId:e.props.smsResultModel.sessionId,code:e.props.form.getFieldValue("code"),userId:e.props.userId,newPassword:e.props.form.getFieldValue("password")}))})}},{key:"setSms",value:function(){if(this.props.userId<=0||void 0===this.props.userId)return l.a.error({message:"\u63d0\u9192",description:"\u8f93\u5165\u7684\u624b\u673a\u53f7\u7801\u4e0d\u6b63\u786e\u6216\u4e0d\u5b58\u5728,\u8bf7\u6838\u5bf9\u540e\u91cd\u65b0\u8f93\u5165"});this.props.sendSms({id:this.props.userId,mobilePhone:this.props.form.getFieldValue("mobile"),associateId:this.props.userId,ownerId:0,tenantTypeId:"changePassword"}),this.send()}},{key:"onMobileChange",value:function(e){var t=e.target.value;""!==t&&11===t.length&&this.props.fetchUser(t)}},{key:"render",value:function(){var e=this;return y.a.createElement("div",{className:k.main},y.a.createElement(p.a,{onSubmit:this.handleSubmit},y.a.createElement(p.a.Item,null,this.props.form.getFieldDecorator("mobile",{rules:[{required:!0,pattern:new RegExp(/^[1][3,4,5,6,7,8,9][0-9]{9}$/,"g"),message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7"},{max:11,message:"\u957f\u5ea6\u4e3a11\u4e2a\u5b57\u7b26"}]})(y.a.createElement(i.a,{placeholder:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7",className:k.restInput,onChange:function(t){return e.onMobileChange(t)},prefix:y.a.createElement(n.a,{type:"mobile",style:{color:"rgba(0,0,0,.25)"}})}))),y.a.createElement(p.a.Item,null,y.a.createElement(o.a,{gutter:8},y.a.createElement(s.a,{span:16},this.props.form.getFieldDecorator("code",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801"}]})(y.a.createElement(i.a,{placeholder:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801",className:k.restInput,prefix:y.a.createElement(n.a,{type:"mail",style:{color:"rgba(0,0,0,.25)"}})}))),y.a.createElement(s.a,{span:8},y.a.createElement(a.a,{disabled:this.state.counting,className:k.getCaptcha,onClick:function(){return e.setSms()}},this.state.counting?this.state.count+"\u79d2\u540e\u91cd\u53d1":"\u53d1\u9001")))),y.a.createElement(p.a.Item,null,this.props.form.getFieldDecorator("password",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801"},{min:6,max:16,message:"\u957f\u5ea6\u4e3a6-16\u4e2a\u5b57\u7b26"}]})(y.a.createElement(i.a,{placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801",type:"password",className:k.restInput,prefix:y.a.createElement(n.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}})}))),y.a.createElement(p.a.Item,null,y.a.createElement(a.a,{htmlType:"button",key:"submit",type:"primary",className:k.buttonRest,loading:this.props.submitting,onClick:function(){return e.handleSubmit()}},"\u786e\u5b9a"))))}}]),t}(x.PureComponent);t.default=p.a.create()(Object(E.connect)(function(e){var t=e.loading,r=e.Module_Wechat_Sms;return{submitting:t.effects[I.ModuleSmsAction.saveResetPassword],restError:r.error.resetPassword,smsResultModel:r.smsResultModel,userId:r.userId,passwordModel:r.passwordModel}},function(e){return{reset:function(t){return e({type:I.ModuleSmsAction.saveResetPassword,payload:t})},sendSms:function(t){return e({type:I.ModuleSmsAction.save,payload:t})},fetchUser:function(t){return e({type:I.ModuleSmsAction.fetchUser,payload:t})}}})(D))}});